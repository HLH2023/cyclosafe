# 配置指南

## 1. 微信小程序AppID配置

✅ **已完成** - 你已经配置了AppID: `wx6a2f44346c272a9a`

配置位置：`src/manifest.json` 第15行

## 2. 腾讯地图Key配置（可选）

### 何时需要配置Key？

**不需要Key的功能（已实现）**：
- ✅ 地图显示
- ✅ 当前位置标记
- ✅ 骑行轨迹绘制
- ✅ GPS定位

**需要Key的高级功能（暂未使用）**：
- ⭕ 地址解析（坐标转地址）
- ⭕ 路径规划
- ⭕ 地点搜索
- ⭕ 周边查询

### 如何配置Key？

#### 方法1：直接配置（推荐）

编辑 `src/config/map.config.js`：

```javascript
export default {
  tencentMapKey: '你的Key', // 填入这里
  // ...其他配置
};
```

#### 方法2：使用环境变量

1. 复制 `.env.example` 为 `.env`
2. 在 `.env` 中填入Key：
   ```
   TENCENT_MAP_KEY=你的Key
   ```

### 申请腾讯地图Key

1. 访问：https://lbs.qq.com/
2. 注册/登录
3. 进入控制台
4. 创建应用
5. 添加Key（选择"微信小程序"类型）
6. 填写小程序AppID: `wx6a2f44346c272a9a`
7. 复制生成的Key

## 3. 开发环境配置

### 安装依赖

```bash
npm install
```

### 运行项目

#### 方式1：HBuilderX（推荐）

1. 打开HBuilderX
2. 文件 -> 导入 -> 从本地目录导入
3. 选择项目目录
4. 运行 -> 运行到小程序模拟器 -> 微信开发者工具

#### 方式2：命令行

```bash
npm run dev:mp-weixin
```

然后在微信开发者工具中导入 `unpackage/dist/dev/mp-weixin` 目录

## 4. 真机测试

### GPS功能测试（必需）

GPS定位功能必须在真机上测试，模拟器无法模拟GPS。

**测试步骤**：

1. 在微信开发者工具中点击"预览"或"真机调试"
2. 使用微信扫描二维码
3. 在手机上打开小程序
4. 点击"开始骑行"
5. 授权位置权限
6. 到户外测试GPS定位

**注意事项**：
- 室内GPS信号弱，建议到室外测试
- 首次定位可能需要3-10秒
- 确保手机GPS已开启
- 确保微信有位置权限

## 5. 权限配置

### 位置权限

已在 `src/manifest.json` 中配置：

```json
{
  "permission": {
    "scope.userLocation": {
      "desc": "用于记录骑行轨迹和提供实时位置服务"
    }
  }
}
```

用户首次使用时会弹出授权提示。

## 6. 配置文件说明

### src/manifest.json
- 应用基本信息
- 微信小程序AppID
- 权限配置
- 页面配置

### src/pages.json
- 页面路由
- 导航栏样式
- TabBar配置

### package.json
- 项目依赖
- 启动脚本
- 项目元信息

### src/config/map.config.js
- 腾讯地图Key（可选）
- 地图默认配置

## 7. 常见问题

### Q: 定位失败怎么办？

**A**: 检查以下几点：
1. 是否在真机上测试（模拟器不支持GPS）
2. 手机GPS是否开启
3. 微信是否有位置权限
4. 是否在室外（室内GPS信号弱）
5. 查看控制台错误信息

### Q: 地图不显示怎么办？

**A**:
1. 基础地图不需要Key，应该可以直接显示
2. 检查网络连接
3. 查看控制台是否有错误
4. 确认pages.json中地图组件配置正确

### Q: 需要配置腾讯地图Key吗？

**A**:
- 基础功能（地图显示、轨迹绘制）**不需要**Key
- 高级功能（地址解析等）才需要Key
- 建议先测试基础功能，再根据需要申请Key

### Q: 如何查看GPS定位精度？

**A**:
在骑行页面的控制台中可以看到位置数据，包含`accuracy`字段（单位：米）。
- 精度 < 20米：优秀
- 精度 20-50米：良好
- 精度 > 50米：较差（会被过滤）

## 8. 下一步

✅ 配置完成后，可以开始测试：

1. 测试首页展示
2. 测试骑行功能（真机）
3. 测试数据保存
4. 测试历史记录
5. 测试设置功能

## 9. 技术支持

如遇问题：
1. 查看 `docs/04-硬件接口使用.md` - 硬件接口详细说明
2. 查看 `docs/03-技术方案.md` - 技术实现细节
3. 查看控制台错误信息
4. 在项目issue中反馈

---

**配置完成后即可开始使用！** 🎉
